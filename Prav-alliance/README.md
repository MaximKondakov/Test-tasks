## <center>ТЕСТОВОЕ ЗАДАНИЕ</center>


В настоящем задании, вы получаете доступ к набору данных о стоимости недвижимости в различных районах штата Калифорния, США. 

Данные хранятся в реляционной БД в виде двух таблиц:

**neighborhoods** - случайная выборка районов штата Калифорния. Каждая строка таблицы представляет собой какой-то район, имеющий такие атрибуты, как:

    - id - уникальный идентификатор, primary key;
    - longitude - географическая долгота, град.;
    - latitude - географическая широта, град.;
    - median_house_value - медианная стоимость жилого дома в данном районе, доллар США;
    - population - численность населения района, чел.;
    - ocean_proximity - кластер по принципу близости к океану, качественная переменная;
    
**cluster_mean_values** - каждая строка данной таблицы представляет собой кластер районов, сгруппированных по принципу близости к океану. Атрибуты:
    
    - ocean_proximity_cluster - кластер по принципу близости к океану, качественная переменная;
    - mean_median_house_value - среднее значение медианной стоимости жилого дома во ВСЕХ районах данного кластера, доллар США;
    
**ОБРАТИТЕ ВНИМАНИЕ**: **mean_median_house_value** - значение для всей генеральной совокупности районов в кластере. Таблица **neighborhoods**, в свою очередь, содержит только ВЫБОРКИ из каждого кластера, но не ген. совокупности. Если вы посчитаете среднее арифметическое **median_house_value** - это будет ВЫБОРОЧНЫМ значением.
***************************************
  
  
**ВАШИ ЗАДАЧИ:**

## 1) Извлечь таблицу **neighborhoods** в датафрейм. В части записей отсутствуют данные в атрибуте **ocean_proximity** (null-значения), их необходимо восстановить. Проведите разведочный анализ, подумайте, как в принципе её возможно решить;
   - Пропущенные значения
    ![image](https://github.com/MaximKondakov/Test-tasks/assets/85742231/631d9a63-6d67-478d-a886-ed04ef1a78be)

Как видим, данные удалили случайным образом, потому что присутвуют пропуски как среди дорогих домов, так и дешевых с разной численностью людей. Для восстановления их испольем RandomForestClassifier.

 - F1 score = 0.9725


## 2) Исправить null-значения **ocean_proximity** в самой БД. Условие: нельзя заменять таблицу в БД на новую, только через обновление значений с помощью SQL;
```
sql =
    UPDATE neighborhoods 
    SET ocean_proximity =
        (SELECT ocean_proximity
         FROM result_data
         WHERE neighborhoods.id = result_data.id)
    WHERE ocean_proximity IS NULL;
```
## 3) С помощью SQL создать объединенный датасет со значениями из двух таблиц БД, т.е. чтобы у каждого района было известно среднее арифметическое медианной стоимости жилья для районов в его кластере. Условие: только с помощью SQL, не с помощью Python;

Добавим дополнительный столбец "mean_median_house_value" в таблицу "neighborhoods" и установим всего его значения нулями
    
```
sql = 
      ALTER TABLE neighborhoods 
      ADD COLUMN mean_median_house_value FLOAT NOT NULL DEFAULT 0
```

   По аналогии с прошлым заданием, обновим все значения столбца "mean_median_house_value", на значения из другой таблицы, которые совпадают по названию района
```
sql = 
      UPDATE neighborhoods
      SET mean_median_house_value = 
      (SELECT cluster_mean_values.mean_median_house_value
      FROM cluster_mean_values   
      WHERE neighborhoods.ocean_proximity = cluster_mean_values.ocean_proximity_cluster
      );
```
   
## 4) Определить форму распределения **median_house_value** в каждом кластере. Определить выборочные средние **median_house_value** и их отклонения от средних ген. совокупностей. Все изобразить графически для каждого кластера. В виде комментария описать ваши выводы о репрезентативности выборок;
   
Вывод:

1. для региона - остров мало количество наблюдений, их 3.
2. стат-тесты на нормальность распределений не прошли все, кроме распределения для острова.
3. т-тест прошли все регионы, это определяет вероятность того, что две выборки взяты из генеральных совокупностей, которые имеют одно и то же среднее.
4. Дополнительно построил Q-Q, потому что p_value не говорит о бимодальном распределении.


## 5) Определить зависимость стоимости жилья от численности населения района в каждом кластере. Описать в виде комментария;
Вывод:
 - Население не коррелирует со стоимостью дома.
   
![image](https://github.com/MaximKondakov/Test-tasks/assets/85742231/6919074b-e2f4-471e-bd9d-c733a8980902)
